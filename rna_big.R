library(readxl)
MEGA_result1new <- read_excel("Downloads/MEGA-result0_new1.xlsx")
View(MEGA_result0)
#samp2 <- samp[,-1]
#rownames(samp2) <- samp[,1]
rnabig <- MEGA_result1new[,-1]
rownames(rnabig) <- MEGA_result1new[,1]
rnabigdist <- as.dist(rnabig)
#rna72clust <- hclust(rna72dist,method="single")
#par(mfrow=c(1,1))
#plot(rna72clust, cex = .5, main= NULL, xlab = "virus name")
#every 18 get grouped so (1,19,37,55) then (2,20,38,56) etc
#240 viruses from 2020
#353 total rows
#59 Wuhan and 54 bat-SARS
wuhsamp <- NULL
set.seed(1120)
wuhsamp <- sort(sample(1:59,40,replace=FALSE))
set.seed(1120)
batsamp <- sort(sample(60:113,40,replace=FALSE))
nrow(rnabig)
i <- 3
DF2 <- DF[seq(from=i, to=nrow(DF), by=4),]
rnawuh1a <- as.dist(rnabig[c(wuhsamp[1],114:116),c(wuhsamp[1],114:116)])
rnawuh2a <- as.dist(rnabig[c(wuhsamp[2],117:119),c(wuhsamp[2],117:119)])
rnawuh3a <- as.dist(rnabig[c(wuhsamp[3],120:122),c(wuhsamp[3],120:122)])
rnawuh4a <- as.dist(rnabig[c(wuhsamp[4],123:125),c(wuhsamp[4],123:125)])
rnawuh5a <- as.dist(rnabig[c(wuhsamp[5],126:128),c(wuhsamp[5],126:128)])
rnawuh6a <- as.dist(rnabig[c(wuhsamp[6],129:131),c(wuhsamp[6],129:131)])
rnawuh7a <- as.dist(rnabig[c(wuhsamp[7],132:134),c(wuhsamp[7],132:134)])
rnawuh8a <- as.dist(rnabig[c(wuhsamp[8],135:137),c(wuhsamp[8],135:137)])
rnawuh9a <- as.dist(rnabig[c(wuhsamp[9],138:140),c(wuhsamp[9],138:140)])
rnawuh10a <- as.dist(rnabig[c(wuhsamp[10],141:143),c(wuhsamp[10],141:143)])
rnawuh11a <- as.dist(rnabig[c(wuhsamp[11],144:146),c(wuhsamp[11],144:146)])
rnawuh12a <- as.dist(rnabig[c(wuhsamp[12],147:149),c(wuhsamp[12],147:149)])
rnawuh13a <- as.dist(rnabig[c(wuhsamp[13],150:152),c(wuhsamp[13],150:152)])
rnawuh14a <- as.dist(rnabig[c(wuhsamp[14],153:155),c(wuhsamp[14],153:155)])
rnawuh15a <- as.dist(rnabig[c(wuhsamp[15],156:158),c(wuhsamp[15],156:158)])
rnawuh16a <- as.dist(rnabig[c(wuhsamp[16],159:161),c(wuhsamp[16],159:161)])
rnawuh17a <- as.dist(rnabig[c(wuhsamp[17],162:164),c(wuhsamp[17],162:164)])
rnawuh18a <- as.dist(rnabig[c(wuhsamp[18],165:167),c(wuhsamp[18],165:167)])
rnawuh19a <- as.dist(rnabig[c(wuhsamp[19],168:170),c(wuhsamp[19],168:170)])
rnawuh20a <- as.dist(rnabig[c(wuhsamp[20],171:173),c(wuhsamp[20],171:173)])
rnawuh21a <- as.dist(rnabig[c(wuhsamp[21],174:176),c(wuhsamp[21],174:176)])
rnawuh22a <- as.dist(rnabig[c(wuhsamp[22],177:179),c(wuhsamp[22],177:179)])
rnawuh23a <- as.dist(rnabig[c(wuhsamp[23],180:182),c(wuhsamp[23],180:182)])
rnawuh24a <- as.dist(rnabig[c(wuhsamp[24],183:185),c(wuhsamp[24],183:185)])
rnawuh25a <- as.dist(rnabig[c(wuhsamp[25],186:188),c(wuhsamp[25],186:188)])
rnawuh26a <- as.dist(rnabig[c(wuhsamp[26],189:191),c(wuhsamp[26],189:191)])
rnawuh27a <- as.dist(rnabig[c(wuhsamp[27],192:194),c(wuhsamp[27],192:194)])
rnawuh28a <- as.dist(rnabig[c(wuhsamp[28],195:197),c(wuhsamp[28],195:197)])
rnawuh29a <- as.dist(rnabig[c(wuhsamp[29],198:200),c(wuhsamp[29],198:200)])
rnawuh30a <- as.dist(rnabig[c(wuhsamp[30],201:203),c(wuhsamp[30],201:203)])
rnawuh31a <- as.dist(rnabig[c(wuhsamp[31],204:206),c(wuhsamp[31],204:206)])
rnawuh32a <- as.dist(rnabig[c(wuhsamp[32],207:209),c(wuhsamp[32],207:209)])
rnawuh33a <- as.dist(rnabig[c(wuhsamp[33],210:212),c(wuhsamp[33],210:212)])
rnawuh34a <- as.dist(rnabig[c(wuhsamp[34],213:215),c(wuhsamp[34],213:215)])
rnawuh35a <- as.dist(rnabig[c(wuhsamp[35],216:218),c(wuhsamp[35],216:218)])
rnawuh36a <- as.dist(rnabig[c(wuhsamp[36],219:221),c(wuhsamp[36],219:221)])
rnawuh37a <- as.dist(rnabig[c(wuhsamp[37],222:224),c(wuhsamp[37],222:224)])
rnawuh38a <- as.dist(rnabig[c(wuhsamp[38],225:227),c(wuhsamp[38],225:227)])
rnawuh39a <- as.dist(rnabig[c(wuhsamp[39],228:230),c(wuhsamp[39],228:230)])
rnawuh40a <- as.dist(rnabig[c(wuhsamp[40],231:233),c(wuhsamp[40],231:233)])
rnabat1a <- as.dist(rnabig[c(batsamp[1],234:236),c(batsamp[1],234:236)])
rnabat2a <- as.dist(rnabig[c(batsamp[2],237:239),c(batsamp[2],237:239)])
rnabat3a <- as.dist(rnabig[c(batsamp[3],240:242),c(batsamp[3],240:242)])
rnabat4a <- as.dist(rnabig[c(batsamp[4],243:245),c(batsamp[4],243:245)])
rnabat5a <- as.dist(rnabig[c(batsamp[5],246:248),c(batsamp[5],246:248)])
rnabat6a <- as.dist(rnabig[c(batsamp[6],249:251),c(batsamp[6],249:251)])
rnabat7a <- as.dist(rnabig[c(batsamp[7],252:254),c(batsamp[7],252:254)])
rnabat8a <- as.dist(rnabig[c(batsamp[8],255:257),c(batsamp[8],255:257)])
rnabat9a <- as.dist(rnabig[c(batsamp[9],258:260),c(batsamp[9],258:260)])
rnabat10a <- as.dist(rnabig[c(batsamp[10],261:263),c(batsamp[10],261:263)])
rnabat11a <- as.dist(rnabig[c(batsamp[11],264:266),c(batsamp[11],264:266)])
rnabat12a <- as.dist(rnabig[c(batsamp[12],267:269),c(batsamp[12],267:269)])
rnabat13a <- as.dist(rnabig[c(batsamp[13],270:272),c(batsamp[13],270:272)])
rnabat14a <- as.dist(rnabig[c(batsamp[14],273:275),c(batsamp[14],273:275)])
rnabat15a <- as.dist(rnabig[c(batsamp[15],276:278),c(batsamp[15],276:278)])
rnabat16a <- as.dist(rnabig[c(batsamp[16],279:281),c(batsamp[16],279:281)])
rnabat17a <- as.dist(rnabig[c(batsamp[17],282:284),c(batsamp[17],282:284)])
rnabat18a <- as.dist(rnabig[c(batsamp[18],285:287),c(batsamp[18],285:287)])
rnabat19a <- as.dist(rnabig[c(batsamp[19],288:290),c(batsamp[19],288:290)])
rnabat20a <- as.dist(rnabig[c(batsamp[20],291:293),c(batsamp[20],291:293)])
rnabat21a <- as.dist(rnabig[c(batsamp[21],294:296),c(batsamp[21],294:296)])
rnabat22a <- as.dist(rnabig[c(batsamp[22],297:299),c(batsamp[22],297:299)])
rnabat23a <- as.dist(rnabig[c(batsamp[23],300:302),c(batsamp[23],300:302)])
rnabat24a <- as.dist(rnabig[c(batsamp[24],303:305),c(batsamp[24],303:305)])
rnabat25a <- as.dist(rnabig[c(batsamp[25],306:308),c(batsamp[25],306:308)])
rnabat26a <- as.dist(rnabig[c(batsamp[26],309:311),c(batsamp[26],309:311)])
rnabat27a <- as.dist(rnabig[c(batsamp[27],312:314),c(batsamp[27],312:314)])
rnabat28a <- as.dist(rnabig[c(batsamp[28],315:317),c(batsamp[28],315:317)])
rnabat29a <- as.dist(rnabig[c(batsamp[29],318:320),c(batsamp[29],318:320)])
rnabat30a <- as.dist(rnabig[c(batsamp[30],321:323),c(batsamp[30],321:323)])
rnabat31a <- as.dist(rnabig[c(batsamp[31],324:326),c(batsamp[31],324:326)])
rnabat32a <- as.dist(rnabig[c(batsamp[32],327:329),c(batsamp[32],327:329)])
rnabat33a <- as.dist(rnabig[c(batsamp[33],330:332),c(batsamp[33],330:332)])
rnabat34a <- as.dist(rnabig[c(batsamp[34],333:335),c(batsamp[34],333:335)])
rnabat35a <- as.dist(rnabig[c(batsamp[35],336:338),c(batsamp[35],336:338)])
rnabat36a <- as.dist(rnabig[c(batsamp[36],339:341),c(batsamp[36],339:341)])
rnabat37a <- as.dist(rnabig[c(batsamp[37],342:344),c(batsamp[37],342:344)])
rnabat38a <- as.dist(rnabig[c(batsamp[38],345:347),c(batsamp[38],345:347)])
rnabat39a <- as.dist(rnabig[c(batsamp[39],348:350),c(batsamp[39],348:350)])
rnabat40a <- as.dist(rnabig[c(batsamp[40],351:353),c(batsamp[40],351:353)])

#par(mar=c(2,2,2,25),mfrow=c(3,1))
#plot(as.dendrogram(hclust(rnawuh1,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh2,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh3,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh4,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh5,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh6,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh7,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh8,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnawuh9,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat1,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat2,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat3,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat4,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat5,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat6,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat7,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat8,method="single")), horiz = TRUE,cex.axis=2)
#plot(as.dendrogram(hclust(rnabat9,method="single")), horiz = TRUE,cex.axis=2)
#need to do these minima still
rnabat_minsa <- NULL
rnabat_minsa[1] <- min(rnabat1a[1:3])
rnabat_minsa[2] <- min(rnabat2a[1:3])
rnabat_minsa[3] <- min(rnabat3a[1:3])
rnabat_minsa[4] <- min(rnabat4a[1:3])
rnabat_minsa[5] <- min(rnabat5a[1:3])
rnabat_minsa[6] <- min(rnabat6a[1:3])
rnabat_minsa[7] <- min(rnabat7a[1:3])
rnabat_minsa[8] <- min(rnabat8a[1:3])
rnabat_minsa[9] <- min(rnabat9a[1:3])
rnabat_minsa[10] <- min(rnabat10a[1:3])
rnabat_minsa[11] <- min(rnabat11a[1:3])
rnabat_minsa[12] <- min(rnabat12a[1:3])
rnabat_minsa[13] <- min(rnabat13a[1:3])
rnabat_minsa[14] <- min(rnabat14a[1:3])
rnabat_minsa[15] <- min(rnabat15a[1:3])
rnabat_minsa[16] <- min(rnabat16a[1:3])
rnabat_minsa[17] <- min(rnabat17a[1:3])
rnabat_minsa[18] <- min(rnabat18a[1:3])
rnabat_minsa[19] <- min(rnabat19a[1:3])
rnabat_minsa[20] <- min(rnabat20a[1:3])
rnabat_minsa[21] <- min(rnabat21a[1:3])
rnabat_minsa[22] <- min(rnabat22a[1:3])
rnabat_minsa[23] <- min(rnabat23a[1:3])
rnabat_minsa[24] <- min(rnabat24a[1:3])
rnabat_minsa[25] <- min(rnabat25a[1:3])
rnabat_minsa[26] <- min(rnabat26a[1:3])
rnabat_minsa[27] <- min(rnabat27a[1:3])
rnabat_minsa[28] <- min(rnabat28a[1:3])
rnabat_minsa[29] <- min(rnabat29a[1:3])
rnabat_minsa[30] <- min(rnabat30a[1:3])
rnabat_minsa[31] <- min(rnabat31a[1:3])
rnabat_minsa[32] <- min(rnabat32a[1:3])
rnabat_minsa[33] <- min(rnabat33a[1:3])
rnabat_minsa[34] <- min(rnabat34a[1:3])
rnabat_minsa[35] <- min(rnabat35a[1:3])
rnabat_minsa[36] <- min(rnabat36a[1:3])
rnabat_minsa[37] <- min(rnabat37a[1:3])
rnabat_minsa[38] <- min(rnabat38a[1:3])
rnabat_minsa[39] <- min(rnabat39a[1:3])
rnabat_minsa[40] <- min(rnabat40a[1:3])
rnawuh_minsa <- NULL
rnawuh_minsa[1] <- min(rnawuh1a[1:3])
rnawuh_minsa[2] <- min(rnawuh2a[1:3])
rnawuh_minsa[3] <- min(rnawuh3a[1:3])
rnawuh_minsa[4] <- min(rnawuh4a[1:3])
rnawuh_minsa[5] <- min(rnawuh5a[1:3])
rnawuh_minsa[6] <- min(rnawuh6a[1:3])
rnawuh_minsa[7] <- min(rnawuh7a[1:3])
rnawuh_minsa[8] <- min(rnawuh8a[1:3])
rnawuh_minsa[9] <- min(rnawuh9a[1:3])
rnawuh_minsa[10] <- min(rnawuh10a[1:3])
rnawuh_minsa[11] <- min(rnawuh11a[1:3])
rnawuh_minsa[12] <- min(rnawuh12a[1:3])
rnawuh_minsa[13] <- min(rnawuh13a[1:3])
rnawuh_minsa[14] <- min(rnawuh14a[1:3])
rnawuh_minsa[15] <- min(rnawuh15a[1:3])
rnawuh_minsa[16] <- min(rnawuh16a[1:3])
rnawuh_minsa[17] <- min(rnawuh17a[1:3])
rnawuh_minsa[18] <- min(rnawuh18a[1:3])
rnawuh_minsa[19] <- min(rnawuh19a[1:3])
rnawuh_minsa[20] <- min(rnawuh20a[1:3])
rnawuh_minsa[21] <- min(rnawuh21a[1:3])
rnawuh_minsa[22] <- min(rnawuh22a[1:3])
rnawuh_minsa[23] <- min(rnawuh23a[1:3])
rnawuh_minsa[24] <- min(rnawuh24a[1:3])
rnawuh_minsa[25] <- min(rnawuh25a[1:3])
rnawuh_minsa[26] <- min(rnawuh26a[1:3])
rnawuh_minsa[27] <- min(rnawuh27a[1:3])
rnawuh_minsa[28] <- min(rnawuh28a[1:3])
rnawuh_minsa[29] <- min(rnawuh29a[1:3])
rnawuh_minsa[30] <- min(rnawuh30a[1:3])
rnawuh_minsa[31] <- min(rnawuh31a[1:3])
rnawuh_minsa[32] <- min(rnawuh32a[1:3])
rnawuh_minsa[33] <- min(rnawuh33a[1:3])
rnawuh_minsa[34] <- min(rnawuh34a[1:3])
rnawuh_minsa[35] <- min(rnawuh35a[1:3])
rnawuh_minsa[36] <- min(rnawuh36a[1:3])
rnawuh_minsa[37] <- min(rnawuh37a[1:3])
rnawuh_minsa[38] <- min(rnawuh38a[1:3])
rnawuh_minsa[39] <- min(rnawuh39a[1:3])
rnawuh_minsa[40] <- min(rnawuh40a[1:3])
mean(rnabat_minsa)
sd(rnabat_minsa)
mean(rnawuh_minsa)
sd(rnawuh_minsa)
(mean(rnabat_minsa)-mean(rnawuh_minsa))/sqrt(var(rnabat_minsa)/40+var(rnawuh_minsa)/40)
